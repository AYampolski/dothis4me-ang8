function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"jm0/":function(e,t,i){"use strict";i.r(t);var n,c=i("ofXK"),o=i("3Pt+"),r=i("tyNb"),a=i("XNiG"),s=i("1G5W"),u=i("fXoL"),b=i("ndxW"),d=i("nmb2"),l=i("aECQ"),f=((n=function(){function e(t,i){_classCallCheck(this,e),this.apiService=t,this.firebaseAuth=i}return _createClass(e,[{key:"getUserInfo",value:function(){var e=this.firebaseAuth.auth.currentUser;return{displayName:e.displayName,uid:e.uid,email:e.email,emailVerified:e.emailVerified}}},{key:"createRequestObj",value:function(e){var t=e.bid,i=e.requirement,n=e.status,c=this.getUserInfo(),o=c.displayName;return{key:null,owner:c.uid,displayName:o,bid:t,isAsked:!1,status:n,requirement:i,ask:null,deal:null}}},{key:"createRequest",value:function(e,t){var i=this.createRequestObj(t);return this.apiService.addAuction(e,i)}},{key:"updateAuction",value:function(e,t,i){return this.apiService.updateAuctionProps(e,t,i)}}]),e}()).\u0275fac=function(e){return new(e||n)(u.Xb(d.a),u.Xb(l.a))},n.\u0275prov=u.Kb({token:n,factory:n.\u0275fac,providedIn:"root"}),n),p=i("DRVo"),v=i("RjVx"),m=i("IRfi"),h=i("A2Vd"),g=i("Xlwt");function k(e,t){1&e&&(u.Tb(0,"div",11),u.yc(1," Requirements are requred "),u.Sb())}function _(e,t){if(1&e&&(u.Tb(0,"div"),u.wc(1,k,2,0,"div",10),u.Sb()),2&e){var i=u.dc();u.Bb(1),u.kc("ngIf",i.controls.requirement.errors.required)}}function S(e,t){1&e&&(u.Tb(0,"div",12),u.yc(1," LOADING... "),u.Sb())}function w(e,t){1&e&&(u.Tb(0,"div"),u.yc(1," Bid is requred "),u.Sb())}function y(e,t){if(1&e&&(u.Tb(0,"div",11),u.wc(1,w,2,0,"div",3),u.Sb()),2&e){var i=u.dc(2);u.Bb(1),u.kc("ngIf",i.controls.bid.errors.required)}}function C(e,t){if(1&e){var i=u.Ub();u.Tb(0,"div",13),u.Tb(1,"div",14),u.yc(2," I bid "),u.Sb(),u.Tb(3,"div",15),u.Tb(4,"mat-form-field",16),u.Pb(5,"input",17),u.Sb(),u.wc(6,y,2,1,"div",10),u.Sb(),u.Tb(7,"div",18),u.Tb(8,"button",19),u.bc("click",(function(e){return u.pc(i),u.dc().createRequest()})),u.yc(9," My bid "),u.Sb(),u.Sb(),u.Sb()}if(2&e){var n=u.dc();u.Bb(4),u.kc("formGroup",n.startBid),u.Bb(2),u.kc("ngIf",n.controls.bid.touched&&n.controls.bid.errors),u.Bb(2),u.kc("disabled",!n.startBid.valid)}}function A(e,t){if(1&e&&(u.Tb(0,"div",20),u.Tb(1,"div"),u.yc(2,"I bid"),u.Sb(),u.Tb(3,"div"),u.Tb(4,"span",21),u.yc(5),u.Sb(),u.Sb(),u.Sb()),2&e){var i=u.dc();u.Bb(5),u.Ac("",i.stateService.selectedAuction.bid," UAH ")}}function x(e,t){if(1&e&&(u.Tb(0,"div",20),u.Tb(1,"div"),u.yc(2),u.ec(3,"titlecase"),u.Sb(),u.Tb(4,"div"),u.Tb(5,"span",22),u.yc(6),u.Sb(),u.Sb(),u.Sb()),2&e){var i=u.dc();u.Bb(2),u.zc(u.fc(3,2,"negotiation")),u.Bb(4),u.Ac(" ",i.stateService.selectedAuction.bid," UAH ")}}function O(e,t){if(1&e){var i=u.Ub();u.Tb(0,"div",23),u.Tb(1,"div",24),u.yc(2,"I bid"),u.Sb(),u.Tb(3,"div",25),u.Pb(4,"input",26,27),u.Sb(),u.Tb(6,"button",28),u.bc("click",(function(e){u.pc(i);var t=u.oc(5);return u.dc().onNewBid(t.value)})),u.yc(7," New bid "),u.Sb(),u.Sb(),u.Tb(8,"div",29),u.Tb(9,"div",30),u.yc(10,"Ask"),u.Sb(),u.Tb(11,"div",31),u.yc(12),u.Sb(),u.Tb(13,"button",32),u.bc("click",(function(e){return u.pc(i),u.dc().onAccept()})),u.yc(14," Accept "),u.Sb(),u.Sb()}if(2&e){var n=u.dc();u.Bb(12),u.Ac(" ",n.stateService.selectedAuction.ask," ")}}var P,T,I,M=((P=function(){function e(t,i,n,c){_classCallCheck(this,e),this.stateService=t,this.api=i,this.formBuilder=n,this.toastService=c,this.destroy$=new a.a,this.updateObserver={next:function(e){},error:function(e){console.warn("Errors witrh updating! ",e)}},this.startBid=this.formBuilder.group({requirement:new o.c("",o.q.required),bid:new o.c("",o.q.required)}),this.controls=this.startBid.controls}return _createClass(e,[{key:"ngOnInit",value:function(){console.log("check init")}},{key:"createAucitonFormInstance",value:function(e,t,i){return{requirement:e,bid:t,status:i}}},{key:"createRequest",value:function(){var e=this,t=this.startBid.controls,i=this.stateService.motionInstance.key,n=this.createAucitonFormInstance(t.requirement.value,t.bid.value,this.stateService.iconList.pending);this.isLoading=!0,this.api.createRequest(i,n).pipe(Object(s.a)(this.destroy$)).subscribe((function(t){switch(t.payload.data().status){case e.stateService.iconList.pending:e.toastService.auctionUpdate("You");break;case e.stateService.iconList.ask:e.toastService.auctionUpdate("By auciton owner");break;case e.stateService.iconList.success:e.toastService.auctionAccept("GRATS")}e.stateService.selectedAuction=t.payload.data(),e.isLoading=!1}),(function(e){console.warn("Error inside creation auctin from requestor: ",e)}))}},{key:"onNewBid",value:function(e){this.stateService.selectedAuction.status=this.stateService.iconList.pending,this.updateAuctionForm({bid:e,status:this.stateService.iconList.pending}).subscribe(this.updateObserver)}},{key:"updateAuctionForm",value:function(e){return this.api.updateAuction(this.stateService.motionInstance.key,this.stateService.selectedAuction.key,e)}},{key:"onAccept",value:function(){this.stateService.selectedAuction.deal=String(this.stateService.selectedAuction.bid),this.updateAuctionForm({deal:this.stateService.selectedAuction.ask,status:this.stateService.iconList.success}).subscribe(this.updateObserver)}},{key:"ngOnDestroy",value:function(){this.destroy$.next(!0),this.destroy$.unsubscribe()}}]),e}()).\u0275fac=function(e){return new(e||P)(u.Ob(b.a),u.Ob(f),u.Ob(o.b),u.Ob(p.a))},P.\u0275cmp=u.Ib({type:P,selectors:[["app-init"]],decls:14,vars:7,consts:[[1,"description-field"],[1,"proposal",3,"formGroup"],["matInput","","placeholder","What I can do for the people","rows","5","formControlName","requirement"],[4,"ngIf"],[1,"actions-section"],["class","loading",4,"ngIf"],[3,"ngIf"],["phase1",""],["class","section--center",4,"ngIf"],["phase4",""],["class","error-field",4,"ngIf"],[1,"error-field"],[1,"loading"],[1,"bid-actions"],[1,"bid-actions__title"],[1,"bid-actions__field"],[3,"formGroup"],["matInput","","formControlName","bid","type","number","min","0","inputmode","numeric","pattern","[0-9]*"],[1,"bid-actions__btn"],["mat-raised-button","","color","warn",3,"disabled","click"],[1,"section--center"],[1,"info"],[1,"success"],[1,"new-bid"],[1,"new-bid__common"],[1,"new-bid__value"],["type","number","value","this.stateService.selectedAuction.bid"],["newBid",""],["mat-raised-button","",1,"new-bid__btn",3,"click"],[1,"accept"],[1,"accept__common"],[1,"accept__value"],["mat-raised-button","","color","primary",1,"accept__btn",3,"click"]],template:function(e,t){1&e&&(u.Tb(0,"form"),u.Pb(1,"app-motion-input"),u.Tb(2,"div",0),u.Tb(3,"mat-form-field",1),u.Pb(4,"textarea",2),u.Sb(),u.wc(5,_,2,1,"div",3),u.Sb(),u.Tb(6,"div",4),u.wc(7,S,2,0,"div",5),u.wc(8,C,10,3,"ng-template",6,7,u.xc),u.wc(10,A,6,1,"div",8),u.wc(11,x,7,4,"div",8),u.wc(12,O,15,1,"ng-template",6,9,u.xc),u.Sb(),u.Sb()),2&e&&(u.Bb(3),u.kc("formGroup",t.startBid),u.Bb(2),u.kc("ngIf",t.controls.requirement.touched&&t.controls.requirement.errors),u.Bb(2),u.kc("ngIf",t.isLoading),u.Bb(1),u.kc("ngIf",!t.stateService.selectedAuction),u.Bb(2),u.kc("ngIf",t.stateService.selectedAuction&&t.stateService.selectedAuction.status===t.stateService.iconList.pending),u.Bb(1),u.kc("ngIf",t.stateService.selectedAuction&&t.stateService.selectedAuction.status===t.stateService.iconList.success),u.Bb(1),u.kc("ngIf",t.stateService.selectedAuction&&t.stateService.selectedAuction.status===t.stateService.iconList.ask))},directives:[o.r,o.k,o.l,v.a,m.a,o.e,h.a,o.a,o.j,o.d,c.l,o.n,o.o,g.a],pipes:[c.q],styles:[".bid-actions[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center;padding:0 5px}.bid-actions__title[_ngcontent-%COMP%]{-webkit-box-flex:1;flex:1 1 auto}.bid-actions__btn[_ngcontent-%COMP%], .bid-actions__field[_ngcontent-%COMP%]{-webkit-box-flex:2;flex:2 1 auto}.proposal[_ngcontent-%COMP%]{width:100%}.accept[_ngcontent-%COMP%], .new-bid[_ngcontent-%COMP%]{display:-webkit-box;display:flex;justify-content:space-around}.new-bid[_ngcontent-%COMP%]{margin-bottom:2em}.new-bid__common[_ngcontent-%COMP%]{-webkit-box-flex:1;flex:1}.new-bid__btn[_ngcontent-%COMP%], .new-bid__value[_ngcontent-%COMP%]{-webkit-box-flex:2;flex:2}.new-bid__btn[_ngcontent-%COMP%]{background-color:#159d20;color:#fff}.accept[_ngcontent-%COMP%]{margin-bottom:2em}.accept__common[_ngcontent-%COMP%]{-webkit-box-flex:1;flex:1 1 auto}.accept__btn[_ngcontent-%COMP%], .accept__value[_ngcontent-%COMP%]{-webkit-box-flex:2;flex:2 1 auto}.actions-section[_ngcontent-%COMP%]{position:relative}.loading[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;color:#fff;z-index:1;background:#e7e2e2}.loading[_ngcontent-%COMP%], .section--center[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center}.section--center[_ngcontent-%COMP%]{-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}",".info[_ngcontent-%COMP%]{color:#159d20}.success[_ngcontent-%COMP%]{color:#317be1}.error-field[_ngcontent-%COMP%]{color:red;font-weight:800}"]}),P),B=i("LRne"),q=i("vkgz"),L=i("lGQG"),j=[{path:"",component:M,canDeactivate:[(T=function(){function e(t,i,n){_classCallCheck(this,e),this.stateService=t,this.route=i,this.auth=n}return _createClass(e,[{key:"canDeactivate",value:function(e,t,i,n){var c=this,o="Do you want to delete this auction and create a new one?";return n.url.includes("/login?logout=true")&&(o="Do you want to log out?"),Object(B.a)(window.confirm(o)).pipe(Object(q.a)((function(e){e&&c.stateService.clearAuctionMotionData()})))}}]),e}(),T.\u0275fac=function(e){return new(e||T)(u.Xb(b.a),u.Xb(r.a),u.Xb(L.a))},T.\u0275prov=u.Kb({token:T,factory:T.\u0275fac,providedIn:"root"}),T)]}],R=((I=function e(){_classCallCheck(this,e)}).\u0275mod=u.Mb({type:I}),I.\u0275inj=u.Lb({factory:function(e){return new(e||I)},imports:[[r.i.forChild(j),o.p,o.f],r.i]}),I),N=i("MSSf"),G=i("FpXt");i.d(t,"RequestorModule",(function(){return U}));var X,U=((X=function e(){_classCallCheck(this,e)}).\u0275mod=u.Mb({type:X}),X.\u0275inj=u.Lb({factory:function(e){return new(e||X)},imports:[[c.c,R,o.f,o.p,m.c,h.b,N.d,g.b,G.a]]}),X)}}]);