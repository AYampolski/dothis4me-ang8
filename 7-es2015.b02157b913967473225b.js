(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"jm0/":function(t,e,i){"use strict";i.r(e);var n=i("ofXK"),c=i("3Pt+"),o=i("tyNb"),s=i("XNiG"),r=i("1G5W"),a=i("fXoL"),b=i("ndxW"),d=i("nmb2"),u=i("aECQ");let l=(()=>{class t{constructor(t,e){this.apiService=t,this.firebaseAuth=e}getUserInfo(){const{displayName:t,uid:e,email:i,emailVerified:n}=this.firebaseAuth.auth.currentUser;return{displayName:t,uid:e,email:i,emailVerified:n}}createRequestObj(t){const{bid:e,requirement:i,status:n}=t,{displayName:c,uid:o}=this.getUserInfo();return{key:null,owner:o,displayName:c,bid:e,isAsked:!1,status:n,requirement:i,ask:null,deal:null}}createRequest(t,e){const i=this.createRequestObj(e);return this.apiService.addAuction(t,i)}updateAuction(t,e,i){return this.apiService.updateAuctionProps(t,e,i)}}return t.\u0275fac=function(e){return new(e||t)(a.Xb(d.a),a.Xb(u.a))},t.\u0275prov=a.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var p=i("DRVo"),f=i("RjVx"),v=i("IRfi"),m=i("A2Vd"),g=i("Xlwt");function h(t,e){1&t&&(a.Tb(0,"div",11),a.yc(1," Requirements are requred "),a.Sb())}function S(t,e){if(1&t&&(a.Tb(0,"div"),a.wc(1,h,2,0,"div",10),a.Sb()),2&t){const t=a.dc();a.Bb(1),a.kc("ngIf",t.controls.requirement.errors.required)}}function w(t,e){1&t&&(a.Tb(0,"div",12),a.yc(1," LOADING... "),a.Sb())}function _(t,e){1&t&&(a.Tb(0,"div"),a.yc(1," Bid is requred "),a.Sb())}function k(t,e){if(1&t&&(a.Tb(0,"div",11),a.wc(1,_,2,0,"div",3),a.Sb()),2&t){const t=a.dc(2);a.Bb(1),a.kc("ngIf",t.controls.bid.errors.required)}}function y(t,e){if(1&t){const t=a.Ub();a.Tb(0,"div",13),a.Tb(1,"div",14),a.yc(2," I bid "),a.Sb(),a.Tb(3,"div",15),a.Tb(4,"mat-form-field",16),a.Pb(5,"input",17),a.Sb(),a.wc(6,k,2,1,"div",10),a.Sb(),a.Tb(7,"div",18),a.Tb(8,"button",19),a.bc("click",(function(e){return a.pc(t),a.dc().createRequest()})),a.yc(9," My bid "),a.Sb(),a.Sb(),a.Sb()}if(2&t){const t=a.dc();a.Bb(4),a.kc("formGroup",t.startBid),a.Bb(2),a.kc("ngIf",t.controls.bid.touched&&t.controls.bid.errors),a.Bb(2),a.kc("disabled",!t.startBid.valid)}}function A(t,e){if(1&t&&(a.Tb(0,"div",20),a.Tb(1,"div"),a.yc(2,"I bid"),a.Sb(),a.Tb(3,"div"),a.Tb(4,"span",21),a.yc(5),a.Sb(),a.Sb(),a.Sb()),2&t){const t=a.dc();a.Bb(5),a.Ac("",t.stateService.selectedAuction.bid," UAH ")}}function x(t,e){if(1&t&&(a.Tb(0,"div",20),a.Tb(1,"div"),a.yc(2),a.ec(3,"titlecase"),a.Sb(),a.Tb(4,"div"),a.Tb(5,"span",22),a.yc(6),a.Sb(),a.Sb(),a.Sb()),2&t){const t=a.dc();a.Bb(2),a.zc(a.fc(3,2,"negotiation")),a.Bb(4),a.Ac(" ",t.stateService.selectedAuction.bid," UAH ")}}function O(t,e){if(1&t){const t=a.Ub();a.Tb(0,"div",23),a.Tb(1,"div",24),a.yc(2,"I bid"),a.Sb(),a.Tb(3,"div",25),a.Pb(4,"input",26,27),a.Sb(),a.Tb(6,"button",28),a.bc("click",(function(e){a.pc(t);const i=a.oc(5);return a.dc().onNewBid(i.value)})),a.yc(7," New bid "),a.Sb(),a.Sb(),a.Tb(8,"div",29),a.Tb(9,"div",30),a.yc(10,"Ask"),a.Sb(),a.Tb(11,"div",31),a.yc(12),a.Sb(),a.Tb(13,"button",32),a.bc("click",(function(e){return a.pc(t),a.dc().onAccept()})),a.yc(14," Accept "),a.Sb(),a.Sb()}if(2&t){const t=a.dc();a.Bb(12),a.Ac(" ",t.stateService.selectedAuction.ask," ")}}let I=(()=>{class t{constructor(t,e,i,n){this.stateService=t,this.api=e,this.formBuilder=i,this.toastService=n,this.destroy$=new s.a,this.updateObserver={next:t=>{},error:t=>{console.warn("Errors witrh updating! ",t)}},this.startBid=this.formBuilder.group({requirement:new c.c("",c.q.required),bid:new c.c("",c.q.required)}),this.controls=this.startBid.controls}ngOnInit(){console.log("check init")}createAucitonFormInstance(t,e,i){return{requirement:t,bid:e,status:i}}createRequest(){const t=this.startBid.controls,e=this.stateService.motionInstance.key,i=this.createAucitonFormInstance(t.requirement.value,t.bid.value,this.stateService.iconList.pending);this.isLoading=!0,this.api.createRequest(e,i).pipe(Object(r.a)(this.destroy$)).subscribe(t=>{switch(t.payload.data().status){case this.stateService.iconList.pending:this.toastService.auctionUpdate("You");break;case this.stateService.iconList.ask:this.toastService.auctionUpdate("By auciton owner");break;case this.stateService.iconList.success:this.toastService.auctionAccept("GRATS")}this.stateService.selectedAuction=t.payload.data(),this.isLoading=!1},t=>{console.warn("Error inside creation auctin from requestor: ",t)})}onNewBid(t){this.stateService.selectedAuction.status=this.stateService.iconList.pending,this.updateAuctionForm({bid:t,status:this.stateService.iconList.pending}).subscribe(this.updateObserver)}updateAuctionForm(t){return this.api.updateAuction(this.stateService.motionInstance.key,this.stateService.selectedAuction.key,t)}onAccept(){this.stateService.selectedAuction.deal=String(this.stateService.selectedAuction.bid),this.updateAuctionForm({deal:this.stateService.selectedAuction.ask,status:this.stateService.iconList.success}).subscribe(this.updateObserver)}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(a.Ob(b.a),a.Ob(l),a.Ob(c.b),a.Ob(p.a))},t.\u0275cmp=a.Ib({type:t,selectors:[["app-init"]],decls:14,vars:7,consts:[[1,"description-field"],[1,"proposal",3,"formGroup"],["matInput","","placeholder","What I can do for the people","rows","5","formControlName","requirement"],[4,"ngIf"],[1,"actions-section"],["class","loading",4,"ngIf"],[3,"ngIf"],["phase1",""],["class","section--center",4,"ngIf"],["phase4",""],["class","error-field",4,"ngIf"],[1,"error-field"],[1,"loading"],[1,"bid-actions"],[1,"bid-actions__title"],[1,"bid-actions__field"],[3,"formGroup"],["matInput","","formControlName","bid","type","number","min","0","inputmode","numeric","pattern","[0-9]*"],[1,"bid-actions__btn"],["mat-raised-button","","color","warn",3,"disabled","click"],[1,"section--center"],[1,"info"],[1,"success"],[1,"new-bid"],[1,"new-bid__common"],[1,"new-bid__value"],["type","number","value","this.stateService.selectedAuction.bid"],["newBid",""],["mat-raised-button","",1,"new-bid__btn",3,"click"],[1,"accept"],[1,"accept__common"],[1,"accept__value"],["mat-raised-button","","color","primary",1,"accept__btn",3,"click"]],template:function(t,e){1&t&&(a.Tb(0,"form"),a.Pb(1,"app-motion-input"),a.Tb(2,"div",0),a.Tb(3,"mat-form-field",1),a.Pb(4,"textarea",2),a.Sb(),a.wc(5,S,2,1,"div",3),a.Sb(),a.Tb(6,"div",4),a.wc(7,w,2,0,"div",5),a.wc(8,y,10,3,"ng-template",6,7,a.xc),a.wc(10,A,6,1,"div",8),a.wc(11,x,7,4,"div",8),a.wc(12,O,15,1,"ng-template",6,9,a.xc),a.Sb(),a.Sb()),2&t&&(a.Bb(3),a.kc("formGroup",e.startBid),a.Bb(2),a.kc("ngIf",e.controls.requirement.touched&&e.controls.requirement.errors),a.Bb(2),a.kc("ngIf",e.isLoading),a.Bb(1),a.kc("ngIf",!e.stateService.selectedAuction),a.Bb(2),a.kc("ngIf",e.stateService.selectedAuction&&e.stateService.selectedAuction.status===e.stateService.iconList.pending),a.Bb(1),a.kc("ngIf",e.stateService.selectedAuction&&e.stateService.selectedAuction.status===e.stateService.iconList.success),a.Bb(1),a.kc("ngIf",e.stateService.selectedAuction&&e.stateService.selectedAuction.status===e.stateService.iconList.ask))},directives:[c.r,c.k,c.l,f.a,v.a,c.e,m.a,c.a,c.j,c.d,n.l,c.n,c.o,g.a],pipes:[n.q],styles:[".bid-actions[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center;padding:0 5px}.bid-actions__title[_ngcontent-%COMP%]{-webkit-box-flex:1;flex:1 1 auto}.bid-actions__btn[_ngcontent-%COMP%], .bid-actions__field[_ngcontent-%COMP%]{-webkit-box-flex:2;flex:2 1 auto}.proposal[_ngcontent-%COMP%]{width:100%}.accept[_ngcontent-%COMP%], .new-bid[_ngcontent-%COMP%]{display:-webkit-box;display:flex;justify-content:space-around}.new-bid[_ngcontent-%COMP%]{margin-bottom:2em}.new-bid__common[_ngcontent-%COMP%]{-webkit-box-flex:1;flex:1}.new-bid__btn[_ngcontent-%COMP%], .new-bid__value[_ngcontent-%COMP%]{-webkit-box-flex:2;flex:2}.new-bid__btn[_ngcontent-%COMP%]{background-color:#159d20;color:#fff}.accept[_ngcontent-%COMP%]{margin-bottom:2em}.accept__common[_ngcontent-%COMP%]{-webkit-box-flex:1;flex:1 1 auto}.accept__btn[_ngcontent-%COMP%], .accept__value[_ngcontent-%COMP%]{-webkit-box-flex:2;flex:2 1 auto}.actions-section[_ngcontent-%COMP%]{position:relative}.loading[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;color:#fff;z-index:1;background:#e7e2e2}.loading[_ngcontent-%COMP%], .section--center[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center}.section--center[_ngcontent-%COMP%]{-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}",".info[_ngcontent-%COMP%]{color:#159d20}.success[_ngcontent-%COMP%]{color:#317be1}.error-field[_ngcontent-%COMP%]{color:red;font-weight:800}"]}),t})();var T=i("LRne"),M=i("vkgz"),P=i("lGQG");const B=[{path:"",component:I,canDeactivate:[(()=>{class t{constructor(t,e,i){this.stateService=t,this.route=e,this.auth=i}canDeactivate(t,e,i,n){let c="Do you want to delete this auction and create a new one?";return n.url.includes("/login?logout=true")&&(c="Do you want to log out?"),Object(T.a)(window.confirm(c)).pipe(Object(M.a)(t=>{t&&this.stateService.clearAuctionMotionData()}))}}return t.\u0275fac=function(e){return new(e||t)(a.Xb(b.a),a.Xb(o.a),a.Xb(P.a))},t.\u0275prov=a.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()]}];let C=(()=>{class t{}return t.\u0275mod=a.Mb({type:t}),t.\u0275inj=a.Lb({factory:function(e){return new(e||t)},imports:[[o.i.forChild(B),c.p,c.f],o.i]}),t})();var q=i("MSSf"),L=i("FpXt");i.d(e,"RequestorModule",(function(){return j}));let j=(()=>{class t{}return t.\u0275mod=a.Mb({type:t}),t.\u0275inj=a.Lb({factory:function(e){return new(e||t)},imports:[[n.c,C,c.f,c.p,v.c,m.b,q.d,g.b,L.a]]}),t})()}}]);